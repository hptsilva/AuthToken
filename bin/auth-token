#!/usr/bin/env php
<?php

$paths = [
    __DIR__ . '/../../../autoload.php',
    __DIR__ . '/../vendor/autoload.php',
];

$autoloader_found = false;
foreach ($paths as $path) {
    if (file_exists($path)) {
        require_once $path;
        $autoloader_found = true;
        break;
    }
}

if (!$autoloader_found) {
    echo "Error: Could not find the Composer autoloader (autoload.php).\n";
    echo "Please make sure you have run 'composer install'.\n";
    exit(1);
}

use AuthToken\Commands\RollbackCommand;
use Symfony\Component\Console\Application;
use AuthToken\Commands\SecretCommand;
use AuthToken\Commands\MigrationCommand;

$application = new Application();
$application->add(new SecretCommand());
$application->add(new MigrationCommand());
$application->add(new RollbackCommand());
try {
    $application->run();
} catch (Exception $e) {
    error_log($e->getMessage());
}